name: "PostgreSQL RETURNING Clause"
description: "Test completion for PostgreSQL RETURNING clause in INSERT/UPDATE/DELETE"

database:
  dialect: "postgresql"
  schemas:
    - "../../../fixtures/schema/postgresql/01_create_tables.sql"
  data:
    - "../../../fixtures/data/postgresql/02_insert_basic_data.sql"

tests:
  - name: "RETURNING after INSERT"
    description: "Should complete columns in RETURNING clause after INSERT"
    sql: "INSERT INTO users (username) VALUES ('test') RETURNING |"
    expect_completion:
      contains:
        - "id"
        - "username"
        - "email"
        - "*"
      min_count: 5

  - name: "RETURNING after UPDATE"
    description: "Should complete columns in RETURNING clause after UPDATE"
    sql: "UPDATE users SET username='test' WHERE id=1 RETURNING |"
    expect_completion:
      contains:
        - "id"
        - "username"
        - "*"
      min_count: 5

  - name: "RETURNING after DELETE"
    description: "Should complete columns in RETURNING clause after DELETE"
    sql: "DELETE FROM users WHERE id=1 RETURNING |"
    expect_completion:
      contains:
        - "id"
        - "username"
        - "*"
      min_count: 5
