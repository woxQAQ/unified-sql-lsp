# ============================================================================
# Basic SELECT Completion Tests
# ============================================================================
# Tests for SELECT clause column name completion
# Context: users table (id, username, email, full_name, age, balance, is_active, created_at, updated_at, last_login, bio, profile_image, phone)

---
description: Simple column name completion
dialect: all
input: |
  SELECT | FROM users
expected: |
  id [Field] users.id
  username [Field] users.username
  email [Field] users.email
  full_name [Field] users.full_name
  age [Field] users.age
  balance [Field] users.balance
  is_active [Field] users.is_active
  created_at [Field] users.created_at
  updated_at [Field] users.updated_at
  last_login [Field] users.last_login
  bio [Field] users.bio
  profile_image [Field] users.profile_image
  phone [Field] users.phone
options: |
  min_items: 12

---
description: Multi-column selection with completion
dialect: all
input: |
  SELECT id, username, | FROM users
expected: |
  email [Field] users.email
  full_name [Field] users.full_name
  age [Field] users.age
  balance [Field] users.balance
options: |
  min_items: 10

---
description: Table-qualified column name completion
dialect: all
input: |
  SELECT users.| FROM users
expected: |
  id [Field] users.id
  username [Field] users.username
  email [Field] users.email
  full_name [Field] users.full_name
options: |
  min_items: 12

---
description: Table alias qualified column completion
dialect: all
input: |
  SELECT u.| FROM users u
expected: |
  id [Field] u.id
  username [Field] u.username
  email [Field] u.email
  full_name [Field] u.full_name
  age [Field] u.age
  balance [Field] u.balance
  is_active [Field] u.is_active
  created_at [Field] u.created_at
options: |
  min_items: 12

---
description: Column completion after DISTINCT
dialect: all
input: |
  SELECT DISTINCT | FROM users
expected: |
  id [Field] users.id
  username [Field] users.username
  email [Field] users.email
  full_name [Field] users.full_name
options: |
  min_items: 10

---
description: Nested query SELECT completion
dialect: all
input: |
  SELECT (SELECT | FROM orders) FROM users
expected: |
  id [Field] orders.id
  user_id [Field] orders.user_id
  order_date [Field] orders.order_date
  total_amount [Field] orders.total_amount
  status [Field] orders.status
options: |
  min_items: 8

---
description: Multiple tables - only shows columns from first
dialect: all
input: |
  SELECT | FROM users u JOIN orders o ON u.id = o.user_id
expected: |
  id [Field] users.id
  username [Field] users.username
  email [Field] users.email
options: |
  min_items: 10

---
description: Completion after comma in SELECT list
dialect: all
input: |
  SELECT id, | FROM users
expected: |
  username [Field] users.username
  email [Field] users.email
  full_name [Field] users.full_name
options: |
  min_items: 10

---
description: Expression with nested function completion
dialect: all
input: |
  SELECT COALESCE(|, 0) FROM users
expected: |
  id [Field] users.id
  username [Field] users.username
  email [Field] users.email
options: |
  min_items: 10

---
description: CASE expression column completion
dialect: all
input: |
  SELECT CASE WHEN | THEN 1 END FROM users
expected: |
  id [Field] users.id
  username [Field] users.username
  is_active [Field] users.is_active
options: |
  min_items: 5

---
description: Aggregate function in SELECT
dialect: all
input: |
  SELECT COUNT(|) FROM users
expected: |
  id [Field] users.id
  username [Field] users.username
  * [Operator]
options: |
  min_items: 5

---
description: JOIN with qualified column in SELECT
dialect: all
input: |
  SELECT o.| FROM orders o JOIN users u ON o.user_id = u.id
expected: |
  id [Field] o.id
  user_id [Field] o.user_id
  order_date [Field] o.order_date
  total_amount [Field] o.total_amount
  status [Field] o.status
options: |
  min_items: 8

---
description: Wildcard followed by additional column
dialect: all
input: |
  SELECT *, | FROM users
expected: |
  id [Field] users.id
  username [Field] users.username
  email [Field] users.email
options: |
  min_items: 10

---
description: Qualified wildcard for specific table
dialect: all
input: |
  SELECT users.*| FROM users
expected: |
options: |
  min_items: 0

---
description: Column completion with expression prefix
dialect: all
input: |
  SELECT 1 + | FROM users
expected: |
  id [Field] users.id
  age [Field] users.age
  balance [Field] users.balance
options: |
  contains: id, age, balance
