# ============================================================================
# Edge Cases and Boundary Condition Tests
# ============================================================================
# Tests for error handling, malformed SQL, special characters, and edge cases

# ========================================
# Empty and Minimal Input
# ========================================

---
description: Empty input - should suggest keywords
dialect: all
input: |
  |
expected: |
  SELECT [Keyword]
  INSERT [Keyword]
  UPDATE [Keyword]
  DELETE [Keyword]
  WITH [Keyword]
  CREATE [Keyword]
  ALTER [Keyword]
  DROP [Keyword]
options: |
  min_items: 5

---
description: Only whitespace before cursor
dialect: all
input: |

  |
expected: |
  SELECT [Keyword]
  INSERT [Keyword]
  WITH [Keyword]
options: |
  min_items: 3

# ========================================
# Syntax Errors
# ========================================

---
description: Misspelled SELECT keyword
dialect: all
input: |
  SELET | FROM users
expected: |
options: |
  min_items: 0

---
description: Missing FROM clause
dialect: all
input: |
  SELECT |
expected: |
  id [Field]
  username [Field]
options: |
  min_items: 2

---
description: Incomplete JOIN
dialect: all
input: |
  SELECT * FROM users JOIN|
expected: |
options: |
  min_items: 0

---
description: Unbalanced parenthesis
dialect: all
input: |
  SELECT * FROM users WHERE (id = 1 |
expected: |
  AND [Keyword]
  OR [Keyword]
options: |
  min_items: 2

---
description: Extra comma
dialect: all
input: |
  SELECT id, , | FROM users
expected: |
  username [Field]
  email [Field]
options: |
  min_items: 2

# ========================================
# Special Characters
# ========================================

---
description: Column with underscore
dialect: all
input: |
  SELECT | FROM users
expected: |
  full_name [Field] users.full_name
  profile_image [Field] users.profile_image
options: |
  contains: full_name, profile_image

---
description: Column name starting with underscore
dialect: all
context: Table has column _private_data
input: |
  SELECT | FROM special_table
expected: |
  _private_data [Field]
options: |
  min_items: 1

---
description: Column with numbers
dialect: all
context: Table has column address2, phone3
input: |
  SELECT | FROM contacts
expected: |
  address2 [Field]
  phone3 [Field]
options: |
  min_items: 2

---
description: Quoted identifier with space
dialect: all
context: Table has column "full name"
input: |
  SELECT | FROM users
expected: |
options: |
  min_items: 2

---
description: Reserved word as identifier
dialect: all
context: Table has column named "select" (quoted)
input: |
  SELECT | FROM reserved_words
expected: |
options: |
  min_items: 2

# ========================================
# Deep Nesting
# ========================================

---
description: Three levels of subqueries
dialect: all
input: |
  SELECT * FROM (SELECT * FROM (SELECT | FROM users) AS t1) AS t2
expected: |
  id [Field] users.id
  username [Field] users.username
options: |
  min_items: 2

---
description: Five levels of nesting
dialect: all
input: |
  SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM users WHERE | ) AS t1 ) AS t2 ) AS t3 ) AS t4
expected: |
  id [Field] users.id
  username [Field] users.username
options: |
  min_items: 2

---
description: Deeply nested function calls
dialect: all
input: |
  SELECT ROUND(AVG(SUM(|))) FROM orders
expected: |
  total_amount [Field] orders.total_amount
options: |
  contains: total_amount

# ========================================
# Ambiguous Situations
# ========================================

---
description: Table and column with same name
dialect: all
context: Table named "user" and column named "user"
input: |
  SELECT | FROM table1
expected: |
  user [Field]
  user [Table]
options: |
  min_items: 2

---
description: Ambiguous column without qualification
dialect: all
input: |
  SELECT id FROM users u JOIN orders o WHERE |
expected: |
  u [Table]
  o [Table]
  u.id [Field]
  o.id [Field]
options: |
  min_items: 4

---
description: Self-reference ambiguity
dialect: all
input: |
  SELECT * FROM employees e1 JOIN employees e2 ON e1.| = e2.manager_id
expected: |
  manager_id [Field] e1.manager_id
  id [Field] e1.id
  department [Field] e1.department
options: |
  min_items: 3

# ========================================
# Long Identifiers
# ========================================

---
description: Very long table name (>50 characters)
dialect: all
context: Table named very_long_table_name_that_exceeds_normal_length_expectations
input: |
  SELECT * FROM |
expected: |
  very_long_table_name_that_exceeds_normal_length_expectations [Table]
options: |
  min_items: 1

---
description: Very long column name
dialect: all
context: Column named extremely_long_column_name_that_goes_on_and_on
input: |
  SELECT | FROM table_with_long_columns
expected: |
  extremely_long_column_name_that_goes_on_and_on [Field]
options: |
  min_items: 1

# ========================================
# Unicode and Special Characters
# ========================================

---
description: Unicode column name
dialect: all
context: Column with emoji or Unicode
input: |
  SELECT | FROM international_table
expected: |
options: |
  min_items: 2

---
description: Mixed case identifiers
dialect: all
context: Column named UserName
input: |
  SELECT | FROM mixed_case_table
expected: |
  UserName [Field]
options: |
  min_items: 1

# ========================================
# Edge Cases with Functions
# ========================================

---
description: Empty function parentheses
dialect: all
input: |
  SELECT COUNT(|) FROM users
expected: |
options: |
  min_items: 0

---
description: Function with no parameters
dialect: all
input: |
  SELECT |() FROM users
expected: |
  NOW [Function]
  COUNT [Function]
  SUM [Function]
options: |
  min_items: 3

---
description: Nested function with 10 levels
dialect: all
input: |
  SELECT SQRT(SQRT(SQRT(SQRT(SQRT(|))))) FROM products
expected: |
  price [Field] products.price
options: |
  contains: price

# ========================================
# Comments and Whitespace
# ========================================

---
description: Cursor after line comment
dialect: all
input: |
  SELECT * FROM users -- this is a comment
  |
expected: |
  WHERE [Keyword]
  ORDER [Keyword]
  LIMIT [Keyword]
options: |
  min_items: 3

---
description: Cursor after block comment
dialect: all
input: |
  SELECT * FROM users /* comment */ |
expected: |
  WHERE [Keyword]
  ORDER [Keyword]
  LIMIT [Keyword]
options: |
  min_items: 3

---
description: Multiple consecutive spaces
dialect: all
input: |
  SELECT * FROM    users    WHERE    |
expected: |
  id [Field] users.id
  username [Field] users.username
options: |
  min_items: 2

---
description: Cursor in middle of word
dialect: all
input: |
  SELECT USE| FROM users
expected: |
  username [Field] users.username
options: |
  min_items: 1

# ========================================
# Type Conversion Edge Cases
# ========================================

---
description: CAST with incomplete type
dialect: all
input: |
  SELECT CAST(id AS |) FROM users
expected: |
  INT [Keyword]
  VARCHAR [Keyword]
  DATE [Keyword]
  DECIMAL [Keyword]
options: |
  contains: INT, VARCHAR, DATE

---
description: CAST with expression
dialect: all
input: |
  SELECT CAST(| AS INT) FROM users
expected: |
  id [Field] users.id
  username [Field] users.username
options: |
  min_items: 2

# ========================================
# NULL and DEFAULT
# ========================================

---
description: NULL in expression
dialect: all
input: |
  SELECT | FROM users WHERE username IS NULL
expected: |
  id [Field] users.id
  email [Field] users.email
options: |
  min_items: 2

---
description: DEFAULT keyword
dialect: all
input: |
  INSERT INTO users (username, email) VALUES (|, DEFAULT)
expected: |
  'test' [Snippet]
  NULL [Keyword]
  DEFAULT [Keyword]
options: |
  min_items: 2

# ========================================
# Performance Edge Cases
# ========================================

---
description: Large number of columns (>50)
dialect: all
context: Table with 100 columns
input: |
  SELECT | FROM wide_table
expected: |
options: |
  min_items: 50

---
description: Large number of tables in FROM
dialect: all
input: |
  SELECT * FROM t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, |
expected: |
  t11 [Table]
  t12 [Table]
options: |
  min_items: 2
